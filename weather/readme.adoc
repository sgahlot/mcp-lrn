= Weather MCP Server (with UI)

:icons: font
:note-caption: :information_source:
:toc: left
:toclevels: 5
:imagesdir: images

:uri-claude: https://claude.ai/download
:uri-weather-api: https://www.weatherapi.com
:uri-streamlit: https://streamlit.io


A Model Context Protocol (MCP) server that provides weather information using the WeatherAPI.com service.

[NOTE]
====
This documentation was generated by Cursor using AI, and then modified manually
to add more details/clarity about testing various tools in Claude and their output.
====

== Features

* *Location Search*: Find locations/cities matching search queries
* *Current Weather*: Get real-time weather information for any location
* *Weather Forecast*: Get weather forecasts for up to 3 days
* *Air Quality Data*: Includes air quality information where available
* *Weather Alerts*: Shows weather alerts and warnings

== UI

* This example has two UIs to showcase the following:
  ** First UI simply allows one to connect to the Weather MCP server and displays all
     the tools and resources from the server in a user friendly format
  ** Second UI (WIP) allows one to connect to the Weather MCP server and invoke the
     tools through the UI.

== Setup

=== 1. Get a WeatherAPI.com API Key

1. Visit link:{uri-weather-api}[WeatherAPI.com]
2. Sign up for a free account
3. Get your API key from the dashboard

=== 2. Set Environment Variable

[source,bash]
----
export WEATHER_API_KEY="your-api-key-here"
----

=== 3. Install Dependencies

[source,bash]
----
uv sync
----

=== 4. Run the Server

[source,bash]
----
uv run python server.py
----

== Available Tools

=== get_current_weather

Get current weather information for a location.

*Parameters:*

* `location` (string): The city name, coordinates, or location to get weather for

*Example:*
----
Get current weather for London
----

=== get_weather_forecast

Get weather forecast for a location.

*Parameters:*

* `location` (string): The city name, coordinates, or location to get forecast for
* `days` (integer): Number of days to forecast (1-3, default: 3)

*Example:*
----
Get 3-day forecast for New York
----

=== search_locations

Search for locations/cities matching a query.

*Parameters:*

* `query` (string): The search query (city name, coordinates, etc.)

*Example:*
----
Find locations matching 'Paris'
----

== Usage with Claude Desktop

Add the following to your Claude Desktop MCP configuration:

[source,json]
----
{
  "mcpServers": {
    "weather": {
      "command": "uv",
      "args": [
        "run",
        "--with",
        "mcp[cli]",
        "mcp",
        "run",
        "<MCP-LRN_REPO_DIR>/weather/server.py"
      ],
      "env": {
        "WEATHER_API_KEY": "your-api-key-here"
      }
    }
  }
}
----

Alternate config to use `.env` file instead of specifying `api-key` direct in the file:

[source,json]
----
{
  "mcpServers": {
    "weather": {
      "command": "uv",
      "args": [
        "run",
        "--env-file",
        "<.ENV_FILE_LOCATION_INCLUDING_ENV_FILE_NAME>",
        "--with",
        "mcp[cli]",
        "mcp",
        "run",
        "<MCP-LRN_REPO_DIR>/weather/server.py"
      ]
    }
  }
}
----

  The <MCP-LRN_REPO_DIR> in the above snippet is where you have cloned the `mcp-lrn` repository.


== API Limits

* *Free Tier*: 1 million calls per month
* *Forecast*: Up to 3 days
* *Historical Data*: Available with paid plans
* *Rate Limiting*: 1000 requests per hour

== Error Handling

The server provides comprehensive error handling for:

* Missing API keys
* Invalid locations
* Network errors
* API rate limits
* Invalid parameters

== Tools usage using Claude Desktop

This section shows how to use various tools of this MCP server in Claude Desktop.
_The tools are invoked in an order to showcase that Claude remembers a query's context
when invoking subsequent tools._

=== Find Location

Type the following query to test the `find location` tool:

* `Search for location matching "Raleigh"`
  ** The result should be as shown in image 1 (_it should find two locations matching **Raleigh**_):

image::claude-01.png[Search Location]
**Image 1**: Search Location


=== Current Weather

Once the `location` data is retrieved, Claude should ask you _if you want to get current weather information
or more details..._.

Type in the following query to get current weather:

* `Yes. Get weather information for Raleigh, North Carolina`
  ** The result should be as shown in image 2:

image::claude-02.png[Current weather - based on previous query]
**Image 2**: Current weather in Raleigh - based on previous query


=== Weather Forecast

With the `Current weather` information displayed, Claude should ask you if _you want to get the forecast for next few days..._

Type the following query to get the `weather forecast` as well:

* `Yes please`
  ** The result should be as shown in image 3:

image::claude-03.png[Weather Forecast - based on previous query]
**Image 3**: Weather Forecast in Raleigh - based on previous query


== UI

This example has the following two UIs available, both of which are built using {uri-streamlit}[Streamlit]:

* First UI allows you to connect to the MCP server and display all the tools and resources from the server after a successful connection.
* Second UI (WIP)

=== UI #1

To run this UI, execute the following command, from the `weather` directory, in a terminal:

* `uv run --with streamlit streamlit run src/ui/get_server_info.py`

This should launch a browser as shown in image 4:

image::ui-disconnected.png[Initial/disconnected client]
**Image 4**: Disconnected client

Provide the Weather API key and click `Connect`. The client should now connect to the server and display all the tools and resources as shown in image 5:

image::ui-connected.png[Connected client]
**Image 5**: Connected client - all tools/resources



== Links:
* {uri-claude}[Claude Desktop download] +
* {uri-weather-api}[WeatherAPI] +
* {uri-streamlit}[Streamlit] +


== License

This project is licensed under the MIT License. 